{
  "files": [
    {
      "filename": "main.py",
      "content": "from fastapi import FastAPI, HTTPException\nfrom fastapi.middleware.cors import CORSMiddleware\nfrom pydantic import BaseModel\nfrom datetime import datetime\nfrom typing import Optional, List\nimport uuid\n\napp = FastAPI()\n\napp.add_middleware(\n    CORSMiddleware,\n    allow_origins=[\"*\"],\n    allow_methods=[\"*\"],\n    allow_headers=[\"*\"],\n)\n\ntasks_db = {}\n\nclass TaskCreate(BaseModel):\n    title: str\n    due_date: Optional[datetime] = None\n    priority: str = \"medium\"\n\nclass TaskUpdate(BaseModel):\n    title: Optional[str] = None\n    due_date: Optional[datetime] = None\n    priority: Optional[str] = None\n\nclass Task(TaskCreate):\n    id: str\n    is_complete: bool = False\n    created_at: datetime\n\n@app.get(\"/api/tasks\")\ndef get_tasks(priority: Optional[str] = None, sort: Optional[str] = None):\n    tasks = list(tasks_db.values())\n    if priority and priority in [\"high\", \"medium\", \"low\"]:\n        tasks = [t for t in tasks if t.priority == priority]\n    if sort == \"due_date\":\n        tasks.sort(key=lambda x: (x.due_date is None, x.due_date))\n    return tasks\n\n@app.post(\"/api/tasks\")\ndef create_task(task: TaskCreate):\n    if task.priority not in [\"high\", \"medium\", \"low\"]:\n        raise HTTPException(status_code=400, detail=\"Priority must be high, medium, or low\")\n    task_id = str(uuid.uuid4())\n    new_task = Task(\n        id=task_id,\n        title=task.title,\n        due_date=task.due_date,\n        priority=task.priority,\n        created_at=datetime.now()\n    )\n    tasks_db[task_id] = new_task\n    return new_task\n\n@app.put(\"/api/tasks/{task_id}\")\ndef update_task(task_id: str, task_update: TaskUpdate):\n    if task_id not in tasks_db:\n        raise HTTPException(status_code=404, detail=\"Task not found\")\n    task = tasks_db[task_id]\n    if task_update.title is not None:\n        task.title = task_update.title\n    if task_update.due_date is not None:\n        task.due_date = task_update.due_date\n    if task_update.priority is not None:\n        if task_update.priority not in [\"high\", \"medium\", \"low\"]:\n            raise HTTPException(status_code=400, detail=\"Priority must be high, medium, or low\")\n        task.priority = task_update.priority\n    return task\n\n@app.patch(\"/api/tasks/{task_id}/complete\")\ndef mark_complete(task_id: str):\n    if task_id not in tasks_db:\n        raise HTTPException(status_code=404, detail=\"Task not found\")\n    tasks_db[task_id].is_complete = True\n    return tasks_db[task_id]\n\n@app.delete(\"/api/tasks/{task_id}\")\ndef delete_task(task_id: str):\n    if task_id not in tasks_db:\n        raise HTTPException(status_code=404, detail=\"Task not found\")\n    del tasks_db[task_id]\n    return {\"message\": \"Task deleted\"}\n",
      "description": "Main FastAPI app with CORS, in-memory storage, and endpoints for tasks"
    }
  ],
  "setup_instructions": "pip install fastapi uvicorn && uvicorn main:app --reload"
}