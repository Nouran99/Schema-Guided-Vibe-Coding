{
  "files": [
    {
      "filename": "index.html",
      "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Todo List</title>\n    <style>\n        body { font-family: sans-serif; max-width: 600px; margin: 20px auto; padding: 0 20px; }\n        h1 { color: #333; }\n        form { margin-bottom: 20px; display: flex; flex-wrap: wrap; gap: 10px; }\n        input, select, button { padding: 10px; font-size: 16px; }\n        button { background: #007bff; color: white; border: none; cursor: pointer; }\n        button:hover { background: #0056b3; }\n        ul { list-style: none; padding: 0; }\n        li { padding: 10px; border: 1px solid #ddd; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; }\n        .complete { text-decoration: line-through; color: #888; }\n        .priority-high { border-left: 5px solid #dc3545; }\n        .priority-medium { border-left: 5px solid #ffc107; }\n        .priority-low { border-left: 5px solid #28a745; }\n        .filters { margin-bottom: 20px; display: flex; gap: 10px; }\n        .error { color: red; margin: 10px 0; }\n    </style>\n</head>\n<body>\n    <h1>Todo List</h1>\n    <div id=\"error\" class=\"error\"></div>\n    <form id=\"taskForm\">\n        <input type=\"text\" id=\"title\" placeholder=\"Task title\" required>\n        <input type=\"date\" id=\"dueDate\" required>\n        <select id=\"priority\" required>\n            <option value=\"high\">High</option>\n            <option value=\"medium\" selected>Medium</option>\n            <option value=\"low\">Low</option>\n        </select>\n        <button type=\"submit\">Add Task</button>\n    </form>\n    <div class=\"filters\">\n        <select id=\"filterPriority\">\n            <option value=\"\">All Priorities</option>\n            <option value=\"high\">High</option>\n            <option value=\"medium\">Medium</option>\n            <option value=\"low\">Low</option>\n        </select>\n        <button id=\"sortDate\">Sort by Due Date</button>\n    </div>\n    <ul id=\"taskList\"></ul>\n    <script>\n        const API_URL = 'http://localhost:8000/api/tasks';\n        let tasks = [];\n        let sortByDate = false;\n\n        async function fetchTasks() {\n            try {\n                const filter = document.getElementById('filterPriority').value;\n                let url = API_URL;\n                if (filter) url += `?priority=${filter}`;\n                if (sortByDate) url += (filter ? '&' : '?') + 'sort=due_date';\n                const res = await fetch(url);\n                if (!res.ok) throw new Error('Failed to fetch tasks');\n                tasks = await res.json();\n                renderTasks();\n                document.getElementById('error').textContent = '';\n            } catch (err) {\n                document.getElementById('error').textContent = 'Error: ' + err.message;\n            }\n        }\n\n        function renderTasks() {\n            const list = document.getElementById('taskList');\n            list.innerHTML = '';\n            tasks.forEach(task => {\n                const li = document.createElement('li');\n                li.className = `priority-${task.priority} ${task.is_complete ? 'complete' : ''}`;\n                li.innerHTML = `\n                    <span>${task.title} (Due: ${task.due_date}) - ${task.priority}</span>\n                    <div>\n                        <button onclick=\"toggleComplete('${task.id}')\">${task.is_complete ? 'Undo' : 'Complete'}</button>\n                        <button onclick=\"deleteTask('${task.id}')\">Delete</button>\n                    </div>\n                `;\n                list.appendChild(li);\n            });\n        }\n\n        async function addTask(event) {\n            event.preventDefault();\n            try {\n                const title = document.getElementById('title').value;\n                const dueDate = document.getElementById('dueDate').value;\n                const priority = document.getElementById('priority').value;\n                const res = await fetch(API_URL, {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify({ title, due_date: dueDate, priority })\n                });\n                if (!res.ok) throw new Error('Failed to add task');\n                document.getElementById('taskForm').reset();\n                fetchTasks();\n            } catch (err) {\n                document.getElementById('error').textContent = 'Error: ' + err.message;\n            }\n        }\n\n        async function toggleComplete(id) {\n            try {\n                const res = await fetch(`${API_URL}/${id}/complete`, { method: 'PATCH' });\n                if (!res.ok) throw new Error('Failed to update task');\n                fetchTasks();\n            } catch (err) {\n                document.getElementById('error').textContent = 'Error: ' + err.message;\n            }\n        }\n\n        async function deleteTask(id) {\n            try {\n                const res = await fetch(`${API_URL}/${id}`, { method: 'DELETE' });\n                if (!res.ok) throw new Error('Failed to delete task');\n                fetchTasks();\n            } catch (err) {\n                document.getElementById('error').textContent = 'Error: ' + err.message;\n            }\n        }\n\n        document.getElementById('taskForm').addEventListener('submit', addTask);\n        document.getElementById('filterPriority').addEventListener('change', fetchTasks);\n        document.getElementById('sortDate').addEventListener('click', () => {\n            sortByDate = !sortByDate;\n            fetchTasks();\n        });\n\n        fetchTasks();\n    </script>\n</body>\n</html>",
      "description": "Main HTML page for todo list app with fixed sort parameter and error handling"
    }
  ],
  "setup_instructions": "Open index.html in browser after starting the backend with: pip install fastapi uvicorn && uvicorn main:app --reload"
}