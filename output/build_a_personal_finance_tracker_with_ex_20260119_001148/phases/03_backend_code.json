{
  "files": [
    {
      "filename": "main.py",
      "content": "from fastapi import FastAPI, HTTPException\nfrom fastapi.middleware.cors import CORSMiddleware\nfrom datetime import date\nfrom typing import List, Optional\nfrom pydantic import BaseModel\n\napp = FastAPI()\n\napp.add_middleware(\n    CORSMiddleware,\n    allow_origins=[\"*\"],\n    allow_credentials=True,\n    allow_methods=[\"*\"],\n    allow_headers=[\"*\"],\n)\n\nclass Category(BaseModel):\n    id: int\n    name: str\n    budget: float\n\nclass Transaction(BaseModel):\n    id: int\n    amount: float\n    type: str\n    category_id: int\n    date: date\n    description: str\n\ncategories_db = {}\ntransactions_db = {}\nnext_cat_id = 1\nnext_txn_id = 1\n\n@app.get(\"/api/categories\", response_model=List[Category])\ndef get_categories():\n    return list(categories_db.values())\n\n@app.post(\"/api/categories\", response_model=Category)\ndef create_category(category: Category):\n    global next_cat_id\n    category.id = next_cat_id\n    categories_db[next_cat_id] = category\n    next_cat_id += 1\n    return category\n\n@app.put(\"/api/categories/{id}\", response_model=Category)\ndef update_category(id: int, budget: float):\n    if id not in categories_db:\n        raise HTTPException(status_code=404, detail=\"Category not found\")\n    categories_db[id].budget = budget\n    return categories_db[id]\n\n@app.get(\"/api/transactions\", response_model=List[Transaction])\ndef get_transactions(start_date: Optional[date] = None, end_date: Optional[date] = None):\n    txn_list = list(transactions_db.values())\n    if start_date:\n        txn_list = [t for t in txn_list if t.date >= start_date]\n    if end_date:\n        txn_list = [t for t in txn_list if t.date <= end_date]\n    return txn_list\n\n@app.post(\"/api/transactions\", response_model=Transaction)\ndef create_transaction(transaction: Transaction):\n    global next_txn_id\n    transaction.id = next_txn_id\n    transactions_db[next_txn_id] = transaction\n    next_txn_id += 1\n    return transaction\n\n@app.put(\"/api/transactions/{id}\", response_model=Transaction)\ndef update_transaction(id: int, transaction: Transaction):\n    if id not in transactions_db:\n        raise HTTPException(status_code=404, detail=\"Transaction not found\")\n    transaction.id = id\n    transactions_db[id] = transaction\n    return transaction\n\n@app.delete(\"/api/transactions/{id}\")\ndef delete_transaction(id: int):\n    if id not in transactions_db:\n        raise HTTPException(status_code=404, detail=\"Transaction not found\")\n    del transactions_db[id]\n    return {\"message\": \"Transaction deleted\"}\n\n@app.get(\"/api/budget-progress\")\ndef get_budget_progress():\n    progress = []\n    for cat_id, cat in categories_db.items():\n        spent = sum(t.amount for t in transactions_db.values() if t.category_id == cat_id and t.type == \"expense\")\n        progress.append({\"category_id\": cat_id, \"category_name\": cat.name, \"budget\": cat.budget, \"spent\": spent})\n    return progress",
      "description": "Main FastAPI app with CORS, in-memory storage, and core endpoints for transactions, categories, and budget progress"
    }
  ],
  "setup_instructions": "pip install fastapi uvicorn && uvicorn main:app --reload"
}